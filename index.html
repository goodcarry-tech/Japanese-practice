<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸŒ¸ äº”åéŸ³èªéŸ³ç·´ç¿’æ©Ÿ - æ«»èŠ±è±ªè¯ç‰ˆ ğŸ™</title>
    <style>
        /* --------------------------------- */
        /* #1. èƒŒæ™¯èˆ‡æ«»èŠ±å‹•ç•« (4K è¦–è¦ºæ•ˆæœ) */
        /* --------------------------------- */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            text-align: center;
            padding: 50px 20px;
            margin: 0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative; /* ç”¨æ–¼èƒŒæ™¯å®šä½ */
            overflow: hidden; /* é˜²æ­¢æ«»èŠ±å‹•ç•«è¶…å‡ºè¦–çª—å°è‡´æ»¾å‹•æ¢ */
            color: #333;
        }

        /* 4K æ«»èŠ±èƒŒæ™¯æ¨¡æ“¬ */
        .background-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: url('https://source.unsplash.com/random/3840x2160?cherry+blossom+tree+no+filter') no-repeat center center; /* æ¨¡æ“¬é«˜ç•«è³ªæ«»èŠ±èƒŒæ™¯ */
            background-size: cover;
        }

        /* æ«»èŠ±é£„è½å‹•ç•« */
        .sakura-fall {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
        }

        .sakura-fall i {
            display: block;
            position: absolute;
            background: #ffb7c5; /* æ«»èŠ±ç²‰è‰² */
            border-radius: 50%;
            width: 8px;
            height: 8px;
            opacity: 0.8;
            box-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
            animation: fall linear infinite;
        }

        @keyframes fall {
            0% { transform: translateY(-10vh) translateX(0) rotateZ(0deg); opacity: 0; }
            10% { opacity: 1; }
            100% { transform: translateY(100vh) translateX(5vw) rotateZ(180deg); opacity: 0.8; }
        }

        /* éš¨æ©Ÿç”Ÿæˆæ«»èŠ±è½è‘‰æ¨£å¼ (JSæœƒç”Ÿæˆ) */
        /* --------------------------------- */
        /* #2. ä»‹é¢æ¨£å¼ */
        /* --------------------------------- */
        .app-container {
            background-color: rgba(255, 255, 255, 0.85); /* åŠé€æ˜ç™½åº•ï¼Œçªå‡ºå…§å®¹ */
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            max-width: 600px;
            width: 90%;
            backdrop-filter: blur(5px); /* è¼•å¾®æ¨¡ç³ŠèƒŒæ™¯ */
            -webkit-backdrop-filter: blur(5px);
        }

        h1 {
            color: #c90076; /* æ«»èŠ±ä¸»é¡Œè‰² */
            margin-bottom: 30px;
        }

        #display-char { 
            font-size: 150px; 
            font-weight: 900; 
            color: #d82c2c; /* é†’ç›®ç´…è‰² */
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        #recognized-result { 
            font-size: 20px; 
            color: #007bff; 
            min-height: 30px;
            margin-bottom: 15px;
        }

        .status-message { 
            font-size: 20px; 
            margin-top: 20px; 
            padding: 10px; 
            border-radius: 8px; 
            transition: all 0.3s;
        }

        .correct { 
            color: #28a745; 
            background-color: #d4edda; 
            border: 1px solid #c3e6cb; 
        }

        .incorrect { 
            color: #dc3545; 
            background-color: #f8d7da; 
            border: 1px solid #f5c6cb; 
        }

        .listening {
            color: #ff9800;
            background-color: #fff3cd;
            border: 1px solid #ffeeba;
        }

        button { 
            padding: 12px 25px; 
            font-size: 18px; 
            cursor: pointer; 
            border: none; 
            border-radius: 25px; 
            background-color: #c90076; 
            color: white; 
            transition: background-color 0.3s, transform 0.1s; 
            margin: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        button:hover:not(:disabled) {
            background-color: #a0005d;
            transform: translateY(-2px);
        }

        button:disabled { 
            background-color: #cccccc; 
            cursor: not-allowed; 
            box-shadow: none;
        }

        /* --------------------------------- */
        /* #3. èªéŸ³è¦–è¦ºåŒ– (Voice Visualizer) */
        /* --------------------------------- */
        #visualizer-container {
            height: 20px;
            width: 100%;
            margin: 15px auto;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        #visualizer-bar {
            width: 0%;
            height: 100%;
            background-color: #4caf50; /* ç¶ è‰²è²æ³¢æ¢ */
            transition: width 0.05s linear;
        }
        
        /* --------------------------------- */
        /* #4. èªéŸ³è¨­å®šé¢æ¿ */
        /* --------------------------------- */
        .controls {
            margin-top: 20px;
            padding: 10px;
            border-top: 1px solid #ddd;
        }

        .control-group {
            display: inline-block;
            margin: 0 10px;
        }

        label {
            font-size: 14px;
            color: #666;
            margin-right: 5px;
        }

        select {
            padding: 5px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }


    </style>
</head>
<body>
    <div class="background-container"></div>
    <div class="sakura-fall" id="sakura-fall-container"></div>

    <div class="app-container">
        <h1>ğŸ™ äº”åéŸ³ç™¼éŸ³æ¸¬é©— (æ«»èŠ±ç‰ˆ)</h1>
        
        <div id="display-char">é»æ“Šé–‹å§‹</div>
        
        <div id="visualizer-container">
            <div id="visualizer-bar"></div>
        </div>

        <p class="status-message" id="status">æº–å‚™å¥½äº†å—ï¼Ÿé»æ“Šã€Œé–‹å§‹ã€æŒ‰éˆ•ï¼</p>
        <p id="recognized-result">ï¼ˆèªéŸ³è­˜åˆ¥çµæœï¼‰</p>
        
        <button id="pronounce-btn">ğŸ”Š è½æ¨™æº–ç™¼éŸ³</button>
        <button id="start-btn">é–‹å§‹æ¸¬é©—</button>

        <div class="controls">
            <div class="control-group">
                <label for="voice-gender">èªéŸ³æ€§åˆ¥:</label>
                <select id="voice-gender">
                    <option value="female">å¥³æ€§ (æ¨™æº–)</option>
                    <option value="male">ç”·æ€§ (æ¨™æº–)</option>
                    <option value="premium_female">å¥³æ€§ (å„ªè³ª/Neural)</option>
                    <option value="premium_male">ç”·æ€§ (å„ªè³ª/Neural)</option>
                </select>
            </div>
        </div>
    </div>

<script>
    // ---------------------------------
    // äº”åéŸ³è³‡æ–™èˆ‡æ ¸å¿ƒè®Šæ•¸
    // ---------------------------------
    const startBtn = document.getElementById('start-btn');
    const pronounceBtn = document.getElementById('pronounce-btn');
    const displayChar = document.getElementById('display-char');
    const statusMessage = document.getElementById('status');
    const recognizedResult = document.getElementById('recognized-result');
    const visualizerBar = document.getElementById('visualizer-bar');
    const voiceGenderSelect = document.getElementById('voice-gender');

    const HINTS = [
        'ã‚', 'ã„', 'ã„ã„', 'ã†', 'ãˆ', 'ãˆãˆ', 'ãŠ', 
        'ã‹', 'ã', 'ã', 'ã‘', 'ã“',
        'ã•', 'ã—', 'ã™', 'ã›', 'ã',
        'ãŸ', 'ã¡', 'ã¤', 'ã¦', 'ã¨',
        'ãª', 'ã«', 'ã¬', 'ã­', 'ã®',
        'ã¯', 'ã²', 'ãµ', 'ã¸', 'ã»',
        'ã¾', 'ã¿', 'ã‚€', 'ã‚', 'ã‚‚',
        'ã‚„', 'ã‚†', 'ã‚ˆ', 'ã‚‰', 'ã‚Š', 'ã‚‹', 'ã‚Œ', 'ã‚',
        'ã‚', 'ã‚’', 'ã‚“', 'ãƒ³', 'ã‚¤', 'ã‚¦', 'ã‚¨', 'ã‚ª' // æ“´å¤§æç¤ºï¼ŒåŒ…æ‹¬ç‰‡å‡å
    ];
    
    const ALL_HIRAGANA_CHARS = [
        'ã‚', 'ã„', 'ã†', 'ãˆ', 'ãŠ', 'ã‹', 'ã', 'ã', 'ã‘', 'ã“',
        'ã•', 'ã—', 'ã™', 'ã›', 'ã', 'ãŸ', 'ã¡', 'ã¤', 'ã¦', 'ã¨',
        'ãª', 'ã«', 'ã¬', 'ã­', 'ã®', 'ã¯', 'ã²', 'ãµ', 'ã¸', 'ã»',
        'ã¾', 'ã¿', 'ã‚€', 'ã‚', 'ã‚‚', 'ã‚„', 'ã‚†', 'ã‚ˆ', 'ã‚‰', 'ã‚Š', 'ã‚‹', 'ã‚Œ', 'ã‚',
        'ã‚', 'ã‚’', 'ã‚“'
    ];

    let currentTargetChar = '';
    let isListening = false;
    
    // ---------------------------------
    // #A. èªéŸ³è¾¨è­˜ (Web Speech API)
    // ---------------------------------
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    if (!SpeechRecognition) {
        statusMessage.textContent = 'âŒ æŠ±æ­‰ï¼Œæ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´ Web Speech APIã€‚è«‹ä½¿ç”¨ Chrome æˆ– Edgeã€‚';
        startBtn.disabled = true;
    } else {
        const recognition = new SpeechRecognition();
        
        recognition.lang = 'ja-JP';
        recognition.continuous = false; 
        recognition.interimResults = false;
        recognition.grammars = new (window.SpeechGrammarList || window.webkitSpeechGrammarList)();
        recognition.grammars.add(new (window.SpeechGrammar)(`#JSGF V1.0; grammar kana; public <kana> = ${HINTS.join(' | ')};`), 1);

        function getKatakana(hira) {
            const map = {'ã‚': 'ã‚¢', 'ã„': 'ã‚¤', 'ã†': 'ã‚¦', 'ãˆ': 'ã‚¨', 'ãŠ': 'ã‚ª', 'ã‹': 'ã‚«', 'ã': 'ã‚­', 'ã': 'ã‚¯', 'ã‘': 'ã‚±', 'ã“': 'ã‚³', 'ã•': 'ã‚µ', 'ã—': 'ã‚·', 'ã™': 'ã‚¹', 'ã›': 'ã‚»', 'ã': 'ã‚½', 'ãŸ': 'ã‚¿', 'ã¡': 'ãƒ', 'ã¤': 'ãƒ„', 'ã¦': 'ãƒ†', 'ã¨': 'ãƒˆ', 'ãª': 'ãƒŠ', 'ã«': 'ãƒ‹', 'ã¬': 'ãƒŒ', 'ã­': 'ãƒ', 'ã®': 'ãƒ', 'ã¯': 'ãƒ', 'ã²': 'ãƒ’', 'ãµ': 'ãƒ•', 'ã¸': 'ãƒ˜', 'ã»': 'ãƒ›', 'ã¾': 'ãƒ', 'ã¿': 'ãƒŸ', 'ã‚€': 'ãƒ ', 'ã‚': 'ãƒ¡', 'ã‚‚': 'ãƒ¢', 'ã‚„': 'ãƒ¤', 'ã‚†': 'ãƒ¦', 'ã‚ˆ': 'ãƒ¨', 'ã‚‰': 'ãƒ©', 'ã‚Š': 'ãƒª', 'ã‚‹': 'ãƒ«', 'ã‚Œ': 'ãƒ¬', 'ã‚': 'ãƒ­', 'ã‚': 'ãƒ¯', 'ã‚’': 'ãƒ²', 'ã‚“': 'ãƒ³'};
            return map[hira] || hira; 
        }

        function isPronunciationCorrect(result, target) {
            let cleanResult = result.replace(/[\sã€ã€‚ï¼ï¼Ÿ,.\-ãƒ¼]/g, '').toLowerCase();
            let cleanTarget = target.toLowerCase(); 
            const targetKatakana = getKatakana(cleanTarget).toLowerCase();

            // ç²¾ç¢ºåŒ¹é…ã€å¹³å‡å/ç‰‡å‡åäº’è½‰ã€ã‚’/ãŠ æ¨¡ç³Š
            if (cleanResult === cleanTarget || cleanResult === targetKatakana) {
                return true;
            }
            if (target === 'ã‚’' && (cleanResult === 'ãŠ' || cleanResult === 'ã‚ª'.toLowerCase())) {
                return true;
            }
            // è™•ç†çŸ­éŸ³/é•·éŸ³æ¨¡ç³Š (ç›®æ¨™ã€Œã„ã€ï¼Œçµæœã€Œã„ã„ã€)
            if (cleanResult.length > cleanTarget.length && cleanResult.startsWith(cleanTarget)) {
                // æ¥å— 'ã„ã„' -> 'ã„' (å¦‚æœè­˜åˆ¥å™¨åœ¨çŸ­éŸ³å¾Œè£œäº†é•·éŸ³)
                 if (cleanResult.length === cleanTarget.length + 1 && cleanResult.includes(cleanTarget)) return true;
            }

            return false;
        }
        
        function setNextTarget() {
            const randomIndex = Math.floor(Math.random() * ALL_HIRAGANA_CHARS.length);
            currentTargetChar = ALL_HIRAGANA_CHARS[randomIndex];
            displayChar.textContent = currentTargetChar;
            recognizedResult.textContent = '';
        }

        // å•Ÿå‹•æµç¨‹
        startBtn.addEventListener('click', async () => {
            if (isListening) recognition.abort();
            setNextTarget(); // è¨­å®šæ–°çš„ç›®æ¨™
            startBtn.disabled = true;
            startBtn.textContent = 'æ­£åœ¨è†è½...';
            try {
                await initWebAudio(); // iOS å–šé†’èˆ‡ AudioContext åˆå§‹åŒ–
                recognition.start();
            } catch (e) {
                console.error('Recognition Start Error:', e);
                if (e.name === 'InvalidStateError') {
                    recognition.abort(); 
                    recognition.start(); 
                } else {
                    statusMessage.textContent = 'âŒ éº¥å…‹é¢¨æ¬Šé™éŒ¯èª¤æˆ–è¨­å‚™ä¸æ”¯æ´ã€‚';
                    statusMessage.className = 'status-message incorrect';
                    startBtn.disabled = false;
                    startBtn.textContent = 'é‡æ–°é–‹å§‹';
                }
            }
        });

        // è™•ç†è­˜åˆ¥çµæœ
        recognition.onresult = (event) => {
            const result = event.results[0][0].transcript.trim();
            const confidence = event.results[0][0].confidence;
            
            recognizedResult.textContent = `è­˜åˆ¥åˆ°: ${result} (æº–ç¢ºåº¦: ${(confidence * 100).toFixed(1)}%)`;
            
            if (isPronunciationCorrect(result, currentTargetChar)) {
                statusMessage.textContent = `âœ… å¤ªæ£’äº†ï¼ç™¼éŸ³æ­£ç¢ºï¼(${currentTargetChar})`;
                statusMessage.className = 'status-message correct';
            } else {
                statusMessage.textContent = `âŒ ç™¼éŸ³éŒ¯èª¤ã€‚æ‚¨èªªçš„æ˜¯ "${result}"ï¼ŒæœŸå¾…çš„æ˜¯ "${currentTargetChar}"ã€‚`;
                statusMessage.className = 'status-message incorrect';
            }
        };
        
        // è™•ç†è­˜åˆ¥é–‹å§‹
        recognition.onstart = () => {
            isListening = true;
            statusMessage.textContent = `ğŸ‘‚ è«‹æ¸…æ™°åœ°ç™¼éŸ³ï¼šã€${currentTargetChar}ã€‘`;
            statusMessage.className = 'status-message listening';
            recognizedResult.textContent = 'ï¼ˆæ­£åœ¨è†è½æ‚¨çš„è²éŸ³...ï¼‰';
            startBtn.disabled = true;
            startVisualizer();
        };
        
        // è™•ç†èªéŸ³çµæŸ (ä½¿ç”¨è€…åœæ­¢èªªè©±)
        recognition.onend = () => {
            isListening = false;
            stopVisualizer();
            // å¦‚æœ onresult æ²’æœ‰è§¸ç™¼ (æ²’æœ‰è­˜åˆ¥çµæœ)ï¼Œå‰‡é¡¯ç¤ºæœªåµæ¸¬åˆ°èªéŸ³
            if (startBtn.disabled) {
                statusMessage.textContent = 'ğŸ¤” æœªåµæ¸¬åˆ°æœ‰æ•ˆèªéŸ³è¼¸å…¥ï¼Œè«‹å†é»æ“Šã€Œä¸‹ä¸€é¡Œã€ä¸¦èªªå¾—æ›´æ¸…æ™°ã€‚';
                statusMessage.className = 'status-message incorrect';
            }
            startBtn.disabled = false;
            startBtn.textContent = 'ä¸‹ä¸€é¡Œ';
            pronounceBtn.disabled = false;
        };
        
        // è™•ç†éŒ¯èª¤
        recognition.onerror = (event) => {
            isListening = false;
            stopVisualizer();
            startBtn.disabled = false;
            startBtn.textContent = 'é‡æ–°é–‹å§‹';
            pronounceBtn.disabled = false;
            
            if (event.error === 'not-allowed') {
                statusMessage.textContent = 'âŒ éŒ¯èª¤ï¼šè«‹å…è¨±éº¥å…‹é¢¨æ¬Šé™ã€‚';
            } else if (event.error === 'no-speech') {
                statusMessage.textContent = 'âš ï¸ éŒ¯èª¤ï¼šåµæ¸¬ä¸åˆ°èªéŸ³ï¼ˆèªªå¾—å¤ªå°è²æˆ–å¤ªæ…¢ï¼‰ã€‚';
            } else {
                statusMessage.textContent = `ç™¼ç”ŸéŒ¯èª¤: ${event.error}ã€‚`;
            }
            statusMessage.className = 'status-message incorrect';
            recognizedResult.textContent = '';
        };

        // ---------------------------------
        // #B. èªéŸ³åˆæˆ (Web Speech Synthesis)
        // ---------------------------------
        const synthesis = window.speechSynthesis;
        const voiceMap = {
            'female': 'Kyoko', // Standard Female 
            'male': 'Otoya',   // Standard Male
            'premium_female': 'Mei', // High quality female (often mapped to premium on some platforms)
            'premium_male': 'Takeo' // High quality male
        };
        let voices = [];
        let voicesLoaded = false;
        
        function populateVoices() {
            voices = synthesis.getVoices().filter(voice => voice.lang.startsWith('ja-'));
            voicesLoaded = true;
            console.log('Voices loaded:', voices.map(v => v.name));
        }

        if (synthesis.onvoiceschanged !== undefined) {
            synthesis.onvoiceschanged = populateVoices;
        } else {
            populateVoices();
        }

        pronounceBtn.addEventListener('click', () => {
            speak(displayChar.textContent);
        });

        function speak(text) {
            if (synthesis.speaking) {
                synthesis.cancel();
            }
            if (!text || text === 'é»æ“Šé–‹å§‹') return;

            const utterance = new SpeechSynthesisUtterance(text);
            const selectedGender = voiceGenderSelect.value;
            const targetName = voiceMap[selectedGender];
            
            const targetVoice = voices.find(voice => voice.name.includes(targetName) || voice.name.toLowerCase().includes(targetName.toLowerCase()));

            if (targetVoice) {
                utterance.voice = targetVoice;
            } else {
                // å¦‚æœæ‰¾ä¸åˆ°ç‰¹å®šçš„èªéŸ³ï¼Œå°±ä½¿ç”¨ç¬¬ä¸€å€‹æ—¥èªèªéŸ³
                utterance.voice = voices.length > 0 ? voices[0] : null;
            }

            utterance.lang = 'ja-JP';
            utterance.rate = 0.8; // ç¨æ…¢ï¼Œæ›´é©åˆå­¸ç¿’
            utterance.pitch = 1.0;
            
            pronounceBtn.disabled = true;
            utterance.onend = () => {
                pronounceBtn.disabled = false;
            };
            synthesis.speak(utterance);
        }

        // ---------------------------------
        // #C. èªéŸ³è¦–è¦ºåŒ–èˆ‡ iOS å–šé†’ (Web Audio API)
        // ---------------------------------
        let audioContext, analyser, microphone, stream;

        async function initWebAudio() {
            try {
                // è«‹æ±‚éº¥å…‹é¢¨æ¬Šé™
                stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                
                // **iOS å–šé†’æ©Ÿåˆ¶ (Silent Oscillator)**
                // åœ¨ AudioContext å•Ÿå‹•æ™‚æ’­æ”¾ä¸€å€‹æ¥µçŸ­çš„ã€ç„¡è²çš„éœ‡ç›ªå™¨
                if (audioContext.state === 'suspended') {
                    const oscillator = audioContext.createOscillator();
                    const gainNode = audioContext.createGain();
                    oscillator.connect(gainNode);
                    gainNode.connect(audioContext.destination);
                    gainNode.gain.value = 0; // éœéŸ³
                    oscillator.start(0);
                    oscillator.stop(0.001); // æ’­æ”¾ 1 æ¯«ç§’
                    await audioContext.resume();
                }

                microphone = audioContext.createMediaStreamSource(stream);
                analyser = audioContext.createAnalyser();
                analyser.fftSize = 256;
                microphone.connect(analyser);

                return true;
            } catch (err) {
                console.error('Error initializing audio:', err);
                statusMessage.textContent = 'âŒ ç„¡æ³•å•Ÿç”¨éº¥å…‹é¢¨ã€‚è«‹æª¢æŸ¥æ¬Šé™è¨­å®šã€‚';
                statusMessage.className = 'status-message incorrect';
                return false;
            }
        }

        let rafId;
        function startVisualizer() {
            if (!analyser) return;

            const bufferLength = analyser.fftSize;
            const dataArray = new Uint8Array(bufferLength);

            function draw() {
                rafId = requestAnimationFrame(draw);

                analyser.getByteFrequencyData(dataArray);

                // è¨ˆç®—å¹³å‡éŸ³é‡
                let sum = 0;
                for(let i = 0; i < bufferLength; i++) {
                    sum += dataArray[i];
                }
                let average = sum / bufferLength;

                // å°‡éŸ³é‡æ˜ å°„åˆ° 0% åˆ° 100% çš„å¯¬åº¦ (å¯èª¿æ•´ä¿‚æ•¸ 2.5 è®“å…¶æ›´éˆæ•)
                const volume = Math.min(100, average * 2.5); 
                visualizerBar.style.width = `${volume}%`;
            }

            draw();
        }

        function stopVisualizer() {
            cancelAnimationFrame(rafId);
            visualizerBar.style.width = '0%';
            // åœæ­¢éº¥å…‹é¢¨ä¸²æµ
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
            }
            // å˜—è©¦é—œé–‰ AudioContext
            if (audioContext && audioContext.state !== 'closed') {
                // audioContext.close(); // ä¸é—œé–‰ï¼Œç•™å¾…ä¸‹æ¬¡ä½¿ç”¨ï¼Œé¿å…é‡æ–°åˆå§‹åŒ–æ¶ˆè€—æ™‚é–“
            }
        }
    }


    // ---------------------------------
    // #D. æ«»èŠ±é£„è½å‹•ç•«ç”Ÿæˆ
    // ---------------------------------
    const sakuraContainer = document.getElementById('sakura-fall-container');
    const NUM_SAKURA = 50; // æ«»èŠ±æ•¸é‡

    function createSakura() {
        for (let i = 0; i < NUM_SAKURA; i++) {
            const petal = document.createElement('i');
            petal.style.left = `${Math.random() * 100}vw`;
            petal.style.animationDuration = `${Math.random() * 10 + 5}s`; // 5s to 15s
            petal.style.animationDelay = `${Math.random() * 5}s`;
            petal.style.width = `${Math.random() * 5 + 3}px`;
            petal.style.height = petal.style.width;
            sakuraContainer.appendChild(petal);
        }
    }

    createSakura();
</script>

</body>
</html>